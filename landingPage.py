# -*- coding: utf-8 -*-
import streamlit as st

st.set_page_config(page_title="HR Hours System", layout="wide")

st.title("HR Hours System")

st.markdown("""
**الوصف العام:**  
هذا النظام يسهّل تسجيل الساعات من الأعضاء ومراجعتها من فريق الموارد البشرية، مع لوحات تحليليّة وتقارير للفترات.

---

###  Member Form – إرسال الساعات
- اختيار **القسم** ← يُرشّح الأسماء والمهام تلقائيًا.
- اختيار **الاسم** من قائمة الأعضاء ضمن القسم (لا يوجد إدخال يدوي).
- اختيار **المهمة** الخاصة بالقسم.
- **التاريخ** (يُفترض اليوم افتراضيًا).
- يتم حساب الساعات تلقائيًا من الدقائق (دقائق ÷ 60) وعرضها.
- عند الإرسال: يُضاف طلب إلى ورقة **Requests** بحالة `pending`.

---

###  HR Review – مراجعة واعتماد
- يعرض **الطلبات المعلّقة** (Pending) في جدول.
- اختيار **رقم الطلب** منسدل من الطلبات المعلّقة فقط.
- اختيار **اسم موظّف الموارد البشرية** منسدل (بدون إدخال يدوي).
- كتابة **ملاحظات** (اختياري).
- **Approve**: يحدّث الطلب إلى `approved` ويُنسَخ (Upsert) إلى ورقة **Approved**.
- **Reject**: يحدّث الطلب إلى `rejected` ويُنسَخ إلى ورقة **Rejected** (لا يؤثّر على Approved).
- يعرض **ملخّص الساعات المعتمدة** لكل عضو (عدد الطلبات + إجمالي الساعات).

---

###  Analytics – التحليلات
- تعتمد فقط على ورقة **Approved** (السجلات المعتمدة).
- تصفية حسب **الفترة** و**الحالة** (إن لزم).
- مؤشرات أساسية:
  - إجمالي الساعات، عدد الطلبات، نسبة الاعتماد.
- جداول ورسوم:
  - **ساعات لكل عضو** (Top)،
  - **ساعات حسب القسم**،
  - **أكثر المهام تنفيذًا**.
- زر **تنزيل ملف بيانات** (CSV) للنتائج المصفاة.

---

###  إدارة الفترة – Period Admin
- عرض **المرجع الزمني الحالي** للفترة.
- زر واحد يقوم بـ:
  1) **تنزيل ملف بيانات** للفترة الحالية (منذ المرجع الزمني).
  2) **بدء فترة جديدة**: يضبط المرجع الزمني للآن ويعيد بناء ورقة **Members_Period**.
- الميزة تحافظ على التاريخ كاملًا؛ لا يتم حذف شيء من **Approved**.
""")
st.caption("ملاحظة: هذا النظام يعتمد على Google Sheets كقاعدة بيانات خلفية.")